
Run the crossbar
----------------

ssh kea
cd /vid/software/devel/ubtest/lab/run
crossbar start --config ../cfg/crossbar-kea.yaml


Run the exporter
----------------

ssh kea
cd /vid/software/devel/ubtest/lab/run
HDCTOOLS=/vid/software/devel/ubtest/standalone-hdctools LG_CROSSBAR=ws://kea:20408/ws labgrid-exporter ../cfg/export_kea.yaml


Sync places
-----------

ellesmere:
cd /vid/software/devel/ubtest/lab
LG_CROSSBAR=ws://kea:20408/ws ../labgrid/contrib/sync-places.py sync cfg/places_kea.yaml


Run the client
--------------

LG_CROSSBAR=ws://kea:20408/ws labgrid-client -p rpi3 acquire
LG_CROSSBAR=ws://kea:20408/ws labgrid-client -c cfg/env_kea.cfg -s uboot console

Building
--------

branch: try
PR: https://github.com/labgrid-project/labgrid/pull/1411

cd ~/u
LG_CROSSBAR=ws://kea:20408/ws labgrid-client \
	-c /vid/software/devel/ubtest/lab/env_rpi_try.cfg \
	-V do-bootstrap 1 -V do-build 1 -p rpi3 -s uboot console


Building for grpc
-----------------

ellesmere:
cd /vid/software/devel/ubtest/labgrid
pip uninstall labngrid && pip install -e ".[dev]" && rm -rf build/ labgrid.egg-info/

ellemere for gitlab
cd /vid/software/devel/ubtest/labgrid
sudo su - gitlab-runner

kea
ssh kea
cd /vid/software/devel/ubtest/labgrid
sudo rm -r build/ labgrid.egg-info && pip uninstall labngrid && pip install .

To run on kea:

terminal 1:
ssh kea
cd /vid/software/devel/ubtest/lab/run
labgrid-coordinator -l kea:20408

terminal 2:
ssh kea
cd /vid/software/devel/ubtest/lab/run
HDCTOOLS=/vid/software/devel/ubtest/standalone-hdctools LG_COORDINATOR=kea:20408 labgrid-exporter ../cfg/export_kea.yaml



Things you may need to do
-------------------------

1. Error calling StartServiceByName for org.freedesktop.UDisks2: Unit udisks2.service is masked.

Do this on kea:

sudo systemctl unmask udisks2

2. labgrid.driver.exception.ExecutionError: ('mkdir -p /var/cache/labgrid/sglass/dcaa3d5dbb98bfde8813eab6cc9051d6ffed0b4a59e28a01bb62b257c0fffd1a/', [], ['mkdir: cannot create directory ‘/var/cache/labgrid’: Permission denied'])

Create /var/cache/labgrid on kea, as per getting started

3. GDBus.Error:org.freedesktop.UDisks2.Error.NotAuthorizedCanObtain: Not authorized to perform operation

https://github.com/coldfix/udiskie/wiki/Permissions

https://superuser.com/questions/1192269/mounting-partitions-without-a-password-using-udisks2/1192349#1192349

4.
sudo usermod --append --groups disk sglass
rock2

5. usbfs: interface 0 claimed by ch341 while 'brltty' sets config #1

apt remove brltty


Lab status 13may23
==================

board                notes
-------------------------
rpi3                 OK
opi_pc               OK
rock2                hangs in SPL
pcduino3             OK, send only
pcduino3_nano        OK
samus                OK
nyan-big             OK, send only
link                 OK
jerry                OK
minnowmax            OK
zynq_zybo            console broken (labgrid issue 1387)
tk1                  send only, cannot enter recovery (labgrid issue 1390)
puma                 no serial output, doesn't work with SD-wire
salmon               no build, doesn't boot
xu3                  fails to boot from SD card
olimex-a20           no console output
opi_pc2              OK
bpi                  OK
rpi2                 OK
edison               console broken (labgrid issue 1387)
bob                  OK, but needs 'powerbtn' on EC console to force board start (broken battery)
lcdk                 no output
ff3399               Broken, have ordered another
sn9260               no build, doesn't boot
coral                OK
rpi3z                OK
bbb                  OK
snow                 OK, send only
kevin                OK
pine64               OK
c4                   OK
rpi4                 OK
rpi0                 OK

21 OK (inc. 3 send only), 10 broken (inc. 3 labgrid issues), total 34
